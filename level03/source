#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <time.h>

void decrypt(int mask)
{
    int len = strlen(str);
    int i = 0;

    while (i < len)
    {
        str[i] = str[i] ^ mask;
        i++;
    }
    if (strncmp(str, "Congratulations!", 17) == 0)
        system("/bin/sh");
    else
        puts("\nInvalid Password");
    return;
}

void test(int nb1, int nb2)
{
    nb1 -= nb2;
    if (nb1 <= 21)
        decrypt(nb1);
    else
        decrypt(rand());
    return;
}

int main(void)
{
    int password;

    puts("***********************************");
    puts("*\t\tlevel03\t\t**");
    puts("***********************************");
    printf("Password:");
    scanf("%d", &password);
    test(password, 322424845);
    return (0);
}
